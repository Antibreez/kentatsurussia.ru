{"version":3,"sources":["code-ragistration.js"],"names":["emailValidation","$warrantyCodeForm","$","$warrantyCode","find","$purchaseDate","$warrantyEmail","$warrantyCity","$warrantyCodeSubmit","warrantyCodeStage","length","hasPurchaseDateError","hasWarrantyCodeError","hasWarrantyEmailError","hasWarrantyCityError","isPurchaseDateValid","console","log","Date","parse","val","split","filter","w","isWarrantyCodeValid","attr","trim","RegExp","test","isWarrantyEmailValid","isWarrantyCityValid","onPurchaseDateSelect","parent","removeClass","removeAttr","datepickerMonths","datepicker","regional","closeText","prevText","nextText","currentText","monthNames","monthNamesShort","dayNames","dayNamesShort","dayNamesMin","weekHeader","dateFormat","firstDay","isRTL","showMonthAfterYear","yearSuffix","changeMonth","changeYear","yearRange","getFullYear","minDate","maxDate","showOtherMonths","onSelect","onChangeMonthYear","setTimeout","each","idx","e","select2","minimumResultsForSearch","Infinity","dropdownCssClass","setDefaults","on","preventDefault","valid","addClass","submit"],"mappings":"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","file":"main.min.js","sourcesContent":["const emailValidation = /^([\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4})?$/\n\nconst $warrantyCodeForm = $('.code-registration__form')\nconst $warrantyCode = $warrantyCodeForm.find('#warranty-code')\nconst $purchaseDate = $warrantyCodeForm.find('#purchase-date')\nconst $warrantyEmail = $warrantyCodeForm.find('#email')\nconst $warrantyCity = $warrantyCodeForm.find('#city')\nconst $warrantyCodeSubmit = $warrantyCodeForm.find('button[type=\"submit\"]')\n\nconst warrantyCodeStage = $warrantyCode.length ? 1 : $warrantyEmail.length ? 2 : 3\n\nlet hasPurchaseDateError = false\nlet hasWarrantyCodeError = false\nlet hasWarrantyEmailError = false\nlet hasWarrantyCityError = false\n\nconst isPurchaseDateValid = () => {\n  console.log('###date', Date.parse($purchaseDate.val()))\n\n  return (\n    $purchaseDate\n      .val()\n      .split('')\n      .filter(w => w === '.').length === 2 && !!Date.parse($purchaseDate.val())\n  )\n}\n\nconst isWarrantyCodeValid = () => {\n  if ($warrantyCode.attr('pattern')) {\n    return $warrantyCode.val().trim() && new RegExp($warrantyCode.attr('pattern')).test($warrantyCode.val())\n  }\n\n  return $warrantyCode.val().trim()\n}\n\nconst isWarrantyEmailValid = () => {\n  if ($warrantyEmail.val().trim() && new RegExp(emailValidation).test($warrantyEmail.val())) {\n    return true\n  }\n\n  return false\n}\n\nconst isWarrantyCityValid = () => {\n  return !!$warrantyCity.val().trim()\n}\n\ndatepickerMonths = [\n  'Январь',\n  'Февраль',\n  'Март',\n  'Апрель',\n  'Май',\n  'Июнь',\n  'Июль',\n  'Август',\n  'Сентябрь',\n  'Октябрь',\n  'Ноябрь',\n  'Декабрь',\n]\n\n$.datepicker.regional['ru'] = {\n  closeText: 'Закрыть',\n  prevText: 'Предыдущий',\n  nextText: 'Следующий',\n  currentText: 'Сегодня',\n  monthNames: datepickerMonths,\n  monthNamesShort: datepickerMonths,\n  dayNames: ['воскресенье', 'понедельник', 'вторник', 'среда', 'четверг', 'пятница', 'суббота'],\n  dayNamesShort: ['вск', 'пнд', 'втр', 'срд', 'чтв', 'птн', 'сбт'],\n  dayNamesMin: ['Вс', 'Пн', 'Вт', 'Ср', 'Чт', 'Пт', 'Сб'],\n  weekHeader: 'Не',\n  dateFormat: 'dd.mm.yy',\n  firstDay: 1,\n  isRTL: false,\n  showMonthAfterYear: false,\n  yearSuffix: '',\n  changeMonth: true,\n  changeYear: true,\n  yearRange: `1990:${new Date().getFullYear()}`,\n  minDate: new Date(1990, 0, 1),\n  maxDate: new Date(),\n  showOtherMonths: true,\n  onSelect: onPurchaseDateSelect,\n  onChangeMonthYear: function () {\n    console.log('###el', $('#ui-datepicker-div').find('select'))\n    setTimeout(() => {\n      $('#ui-datepicker-div')\n        .find('select')\n        .each((idx, e) => {\n          $(e).select2({\n            minimumResultsForSearch: Infinity,\n            dropdownCssClass: 'datepicker-dropdown',\n          })\n        })\n    }, 100)\n  },\n}\n\n$.datepicker.setDefaults($.datepicker.regional['ru'])\n\n$('#purchase-date').datepicker()\n\n$('#purchase-date').on('click', function () {\n  const el = $('#ui-datepicker-div').find('select')\n\n  el.each((idx, e) => {\n    $(e).select2({\n      minimumResultsForSearch: Infinity,\n      dropdownCssClass: 'datepicker-dropdown',\n    })\n  })\n})\n\nfunction onPurchaseDateSelect() {\n  hasPurchaseDateError = false\n  $purchaseDate.parent().removeClass('is--invalid')\n\n  if (!hasWarrantyCodeError && !hasPurchaseDateError) $warrantyCodeSubmit.removeAttr('disabled')\n}\n\n$warrantyCode.on('input', function (e) {\n  hasWarrantyCodeError = false\n  $warrantyCode.parent().removeClass('is--invalid')\n\n  if (!hasWarrantyCodeError && !hasPurchaseDateError) $warrantyCodeSubmit.removeAttr('disabled')\n})\n\n$purchaseDate.on('input', function (e) {\n  hasPurchaseDateError = false\n  $purchaseDate.parent().removeClass('is--invalid')\n\n  if (!hasWarrantyCodeError && !hasPurchaseDateError) $warrantyCodeSubmit.removeAttr('disabled')\n})\n\n$warrantyEmail.on('input', function () {\n  hasWarrantyEmailError = false\n  $warrantyEmail.parent().removeClass('is--invalid')\n\n  if (!hasWarrantyEmailError && !hasWarrantyCityError) $warrantyCodeSubmit.removeAttr('disabled')\n})\n\n$warrantyCity.on('input', function () {\n  hasWarrantyCityError = false\n  $warrantyCity.parent().removeClass('is--invalid')\n\n  if (!hasWarrantyEmailError && !hasWarrantyCityError) $warrantyCodeSubmit.removeAttr('disabled')\n})\n\n$warrantyCodeSubmit.on('click', function (e) {\n  e.preventDefault()\n\n  if (warrantyCodeStage === 1) {\n    let valid = true\n\n    if (!isWarrantyCodeValid()) {\n      hasWarrantyCodeError = true\n      $warrantyCode.parent().addClass('is--invalid')\n      valid = false\n    }\n\n    if (!isPurchaseDateValid()) {\n      hasPurchaseDateError = true\n      $purchaseDate.parent().addClass('is--invalid')\n      valid = false\n    }\n\n    console.log('valid', valid)\n\n    if (valid) {\n      $warrantyCodeForm.find('form').submit()\n    } else {\n      $warrantyCodeSubmit.attr('disabled', true)\n    }\n  }\n\n  if (warrantyCodeStage === 2) {\n    let valid = true\n\n    if (!isWarrantyEmailValid()) {\n      hasWarrantyEmailError = true\n      $warrantyEmail.parent().addClass('is--invalid')\n      valid = false\n    }\n\n    if (!isWarrantyCityValid()) {\n      hasWarrantyCityError = true\n      $warrantyCity.parent().addClass('is--invalid')\n      valid = false\n    }\n\n    if (valid) {\n      $warrantyCodeForm.find('form').submit()\n    } else {\n      $warrantyCodeSubmit.attr('disabled', true)\n    }\n  }\n})\n"]}